clear all
%close all
clc
a=[-0.980685 -0.771995 -0.563305 -0.354615 -0.145925 0.062765 0.271455 0.480145 0.688835 0.897525 1.106215 1.314905 1.523595 1.732285 1.940975 2.149665 2.358355 2.567045 2.775735];
f=[0.00097112 -0.00102152 0.00906965 0.01404316 0.09012 0.30171582 0.99627084 1.3690832 -2.99681171 1.65463068 -0.59399277 0.22329813 -0.10119309 0.05186135 -0.02748647 0.01384932 -0.00599074 0.00190463 -0.0003216];


Rho_h=[15 250];
Rho_v=[30 1000];
Rho=sqrt(Rho_h.*Rho_v);
f1=sqrt(Rho_v/Rho_h);
H=[4];
h=f1.*H;
N=length(Rho);
T(N,1:19)=Rho(N);
%s=[1.5,2,3,4,6,8,10,15,20,25,30,40,50,60,80,100,120,140,160,180,200,250,300,350,400,500,600,800,1000];
s=logspace(0,2,30);
for kk=1:length(s)
ss=s(kk);
lamda=10.^(a-log10(ss));
    for k=N:-1:2
    for j=1:19    
        T(k-1,j)=(T(k,j)+Rho(k-1)*tanh(lamda(j)*h(k-1)))/(1+(T(k,j))*tanh(lamda(j)*h(k-1))/Rho(k-1));
        
        
    end
    end
  T1=T(1,:)   ;
rhoa(kk)= f*T1' ;
end


figure(1000)
loglog(s,rhoa,'-r');
hold on;
  

        






    
    
 
    
    